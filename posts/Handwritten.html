<html>
<head><meta name="generator" content="Hexo 3.9.0">
	
	<title>Handwritten code</title>
	<meta name="keywords" content="maochong.xin,毛崇鑫,毛崇鑫的blog">

    <meta https-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
	   <link href="/css/main.css?v=3" rel="stylesheet" type="text/css">
    
        <script src="/js/util.js"></script>
        <script>
            if(isMobile()) {
                loadjscssfile('../css/mobile.css', 'css');
            } else {
                loadjscssfile('../css/desktop.css', 'css');
            }
        </script> 
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=3">
    
    

</head>

<body>


<h2 class="title">Handwritten code</h2>
<!---
<div style="text-align:center;margin-top: -10px;">
<div class="article-category">
发表于2019年9月19日




 </div>
--->
</div>

<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#String-API"><span class="toc-text">String API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strlen"><span class="toc-text">strlen</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strcpy"><span class="toc-text">strcpy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strstr"><span class="toc-text">strstr</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#atoi"><span class="toc-text">atoi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Substring-lookup"><span class="toc-text">Substring lookup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#KMP"><span class="toc-text">KMP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boyer-Moore"><span class="toc-text">Boyer-Moore</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Rabin-Karp"><span class="toc-text">Rabin-Karp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stack-and-Queue"><span class="toc-text">Stack and Queue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hannota"><span class="toc-text">Hannota</span></a></li></ol>
<h2 id="String-API"><a href="#String-API" class="headerlink" title="String API"></a>String API</h2><h2 id="strlen"><a href="#strlen" class="headerlink" title="strlen"></a>strlen</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">size_t</span> <span class="built_in">strlen</span>(<span class="keyword">const</span> <span class="keyword">char</span>* str) &#123;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* s = str;</span><br><span class="line">	<span class="keyword">while</span>(*s) &#123; ++s; &#125;</span><br><span class="line">	<span class="keyword">return</span> s - str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="strcpy"><a href="#strcpy" class="headerlink" title="strcpy"></a>strcpy</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">strcpy</span><span class="params">(<span class="keyword">char</span>* to, <span class="keyword">const</span> <span class="keyword">char</span>* from)</span> </span>&#123;</span><br><span class="line">	assert(to != <span class="literal">NULL</span> &amp;&amp; from != <span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">char</span>* p = to;</span><br><span class="line">	<span class="keyword">while</span> (*p++ = *from++);</span><br><span class="line">	<span class="keyword">return</span> to;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="strstr"><a href="#strstr" class="headerlink" title="strstr"></a>strstr</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">strstr</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *haystack, <span class="keyword">const</span> <span class="keyword">char</span> *needle)</span> </span>&#123;</span><br><span class="line">      <span class="comment">// if needle is empty return the full string</span></span><br><span class="line">      <span class="keyword">if</span> (!*needle) <span class="keyword">return</span> (<span class="keyword">char</span>*) haystack;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> *p1;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> *p2;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> *p1_advance = haystack; </span><br><span class="line">	<span class="keyword">for</span> (p2 = &amp;needle[<span class="number">1</span>]; *p2; ++p2) &#123;</span><br><span class="line">		p1_advance++; <span class="comment">// advance p1_advance M-1 times</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (p1 = haystack; *p1_advance; p1_advance++) &#123; </span><br><span class="line">		<span class="keyword">char</span> *p1_old = (<span class="keyword">char</span>*) p1;</span><br><span class="line">		p2 = needle;</span><br><span class="line">		<span class="keyword">while</span> (*p1 &amp;&amp; *p2 &amp;&amp; *p1 == *p2) &#123;</span><br><span class="line">		p1++; p2++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (!*p2) <span class="keyword">return</span> p1_old;</span><br><span class="line">		p1 = p1_old + <span class="number">1</span>; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="atoi"><a href="#atoi" class="headerlink" title="atoi"></a>atoi</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">atoi</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *str)</span> </span>&#123; </span><br><span class="line">	<span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> sign = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (str[i] == <span class="string">' '</span> &amp;&amp; i &lt; len) ++i;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (str[i] == <span class="string">'+'</span>) ++i;</span><br><span class="line">	<span class="keyword">if</span> (str[i] == <span class="string">'-'</span>) &#123; sign = <span class="number">-1</span>; ++i; &#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (; i &lt; len; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (str[i] &lt; <span class="string">'0'</span> || str[i] &gt; <span class="string">'9'</span>) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span> (num &gt; INT_MAX / <span class="number">10</span> || </span><br><span class="line">			num == INT_MAX / <span class="number">10</span> &amp;&amp;</span><br><span class="line">				(str[i] - <span class="string">'0'</span>) &gt; INT_MAX % <span class="number">10</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> sign == <span class="number">-1</span> ? INT_MIN : INT_MAX;</span><br><span class="line">		&#125;</span><br><span class="line">		num = num * <span class="number">10</span> + str[i] - <span class="string">'0'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> num * sign;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Substring-lookup"><a href="#Substring-lookup" class="headerlink" title="Substring lookup"></a>Substring lookup</h2><h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">compute_prefix</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *pattern, <span class="keyword">int</span> next[])</span> </span>&#123; </span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> m = <span class="built_in">strlen</span>(pattern);</span><br><span class="line">	next[<span class="number">0</span>] = j;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">	<span class="keyword">while</span> (j &gt; <span class="number">-1</span> &amp;&amp; pattern[j + <span class="number">1</span>] != pattern[i]) j = next[j];</span><br><span class="line">	<span class="keyword">if</span> (pattern[i] == pattern[j + <span class="number">1</span>]) j++;</span><br><span class="line">		next[i] = j;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *text, <span class="keyword">const</span> <span class="keyword">char</span> *pattern)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> j = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> n = <span class="built_in">strlen</span>(text);</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> m = <span class="built_in">strlen</span>(pattern);</span><br><span class="line">	<span class="keyword">if</span> (n == <span class="number">0</span> &amp;&amp; m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">/* "","" */</span> </span><br><span class="line">	<span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">/* "a","" */</span></span><br><span class="line">	<span class="keyword">int</span> *next = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * m);</span><br><span class="line">	compute_prefix(pattern, next);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">		<span class="keyword">while</span> (j &gt; <span class="number">-1</span> &amp;&amp; pattern[j + <span class="number">1</span>] != text[i]) j = next[j];</span><br><span class="line">		<span class="keyword">if</span> (text[i] == pattern[j + <span class="number">1</span>]) j++; </span><br><span class="line">		<span class="keyword">if</span> (j == m - <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">free</span>(next);</span><br><span class="line">			<span class="keyword">return</span> i-j; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">free</span>(next);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Boyer-Moore"><a href="#Boyer-Moore" class="headerlink" title="Boyer-Moore"></a>Boyer-Moore</h2><h2 id="Rabin-Karp"><a href="#Rabin-Karp" class="headerlink" title="Rabin-Karp"></a>Rabin-Karp</h2><h2 id="Stack-and-Queue"><a href="#Stack-and-Queue" class="headerlink" title="Stack and Queue"></a>Stack and Queue</h2><h2 id="Hannota"><a href="#Hannota" class="headerlink" title="Hannota"></a>Hannota</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hanoi</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">char</span> x, <span class="keyword">char</span> y, <span class="keyword">char</span> z)</span> </span>&#123; </span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d from %c to %c\n"</span>, n, x, z); <span class="keyword">return</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		hanoi(n<span class="number">-1</span>, x, z, y);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d from %c to %c\n"</span>, n, x, z);</span><br><span class="line">		hanoi(n<span class="number">-1</span>, y, x, z);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<!--<a href="https://maochong.xin/posts/Handwritten.html#disqus_thread" class="article-comment-link">Comments</a>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
-->
<div style="display:none">
<script src="https://s4.cnzz.com/stat.php?id=&web_id=" language="JavaScript"></script>script>
</div>






</body>
</html>